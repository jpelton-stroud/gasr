<!-- jQuery & Bootstrap JavaScript Bundle with Popper -->
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
  crossorigin="anonymous"
></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Custom JS -->
<script>
  $(function () {
    initializeAlertBtns();
    initializeVariableModal();
  });

  function initializeVariableModal() {
    $("#varModal").on("show.bs.modal", (event) => {
      const button = event.relatedTarget;
      const btnName = button.getAttribute("id");

      $(".modal-title").text("Variable Modal Example");
      $(".modal-body").html(`
        This modal was triggered by the ${btnName} button
      `);
      $(".modal-footer").text("You can put other stuff down here");
    });
  }

  function initializeAlertBtns() {
    $("#alert").click(() => {
      alert({ message: "clicked", type: "info" });
    });

    $("#alertSuccess").click(() => {
      google.script.run.withSuccessHandler(alert).scriptSuccess(true);
    });
    $("#alertFailure").click(() => {
      google.script.run.withFailureHandler(alert).scriptSuccess(false);
    });
  }

  function alert({ message, type }) {
    if (!type) type = "danger";

    const alertPlaceholder = $("#liveAlertPlaceholder");
    const wrapper = $("<div>");

    wrapper.html(`
      <div class="alert alert-${type} alert-dismissible" role="alert">
        ${message}
        <button 
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
          aria-label="Close"
        ></button>
      </div>
    `);

    alertPlaceholder.append(wrapper);
  }
</script>
